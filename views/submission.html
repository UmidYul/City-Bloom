<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–î–µ—Ç–∞–ª—å –ø–æ—Å–∞–¥–∫–∏ ‚Äî City Bloom</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="/styles.css" />
</head>

<body>
    <div class="app">
        <header class="site-header">
            <a class="logo" href="/">City Bloom</a>
        </header>

        <main style="margin-top:12px">
            <div class="card">
                <h2 id="submissionTitle" style="margin-top:0">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</h2>
                <div id="submissionMeta" class="muted" style="font-size:0.9rem">&nbsp;</div>

                <div id="submissionMap"
                    style="height:200px;border-radius:8px;overflow:hidden;margin:12px 0;background:#f0f0f0"></div>

                <div style="margin:12px 0">
                    <h4 style="margin:8px 0 4px">–í–∏–¥–µ–æ –î–û</h4>
                    <video id="beforeVideo" controls
                        style="width:100%;border-radius:8px;background:#000;max-height:300px;object-fit:cover"></video>
                </div>

                <div style="margin:12px 0">
                    <h4 style="margin:8px 0 4px">–í–∏–¥–µ–æ –ü–û–°–õ–ï</h4>
                    <video id="afterVideo" controls
                        style="width:100%;border-radius:8px;background:#000;max-height:300px;object-fit:cover"></video>
                </div>

                <div style="margin:12px 0;padding:12px;background:#f8f9fa;border-radius:8px">
                    <h4 style="margin:0 0 8px">–û–ø–∏—Å–∞–Ω–∏–µ</h4>
                    <div id="submissionDescription" style="font-size:0.95rem;line-height:1.5"></div>
                </div>

                <div id="adminActions"
                    style="display:none;margin-top:12px;padding-top:12px;border-top:1px solid #e6e9ef">
                    <h4 style="margin-top:0">–î–µ–π—Å—Ç–≤–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h4>
                    <div style="display:grid;gap:12px;grid-template-columns:1fr 1fr">
                        <button id="approveBtn" style="background:#4CAF50">–û–¥–æ–±—Ä–∏—Ç—å</button>
                        <button id="declineBtn" style="background:#f44336">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="/" class="nav-item">
            <span class="icon">üè†</span>
            <span>–ì–ª–∞–≤–Ω–∞—è</span>
        </a>
        <a href="/map" class="nav-item">
            <span class="icon">üó∫Ô∏è</span>
            <span>–ö–∞—Ä—Ç–∞</span>
        </a>
        <a href="/exchange" class="nav-item">
            <span class="icon">üíù</span>
            <span>–ú–∞–≥–∞–∑–∏–Ω</span>
        </a>
        <a href="/ranking" class="nav-item">
            <span class="icon">üèÜ</span>
            <span>–†–µ–π—Ç–∏–Ω–≥</span>
        </a>
        <a href="#" class="nav-item" id="profileNavLink">
            <span class="icon">üë§</span>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </a>
    </nav>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const meRes = await fetch('/api/me')
                if (meRes.ok) {
                    const me = await meRes.json()
                    document.getElementById('profileNavLink').href = `/profile/${me.id}`
                }
            } catch (err) {
                console.error('Failed to load user:', err)
            }
        })
    </script>
    <script src="/nav.js"></script>
    <script src="/submission.js"></script>
</body>

</html>