<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–∞–¥–∫—É ‚Äî City Bloom</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>

<body>
    <div class="app">
        <header class="site-header">
            <a class="logo" href="/">City Bloom</a>
        </header>

        <main style="margin-top:12px;max-width:100%">
            <div class="card">
                <h2 style="margin-top:0">–°–∞–∂–∞–π. –£—Ö–∞–∂–∏–≤–∞–π. –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π.</h2>
                <p class="muted" style="font-size:0.9rem;margin:4px 0">–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–º —Ä–∞—Å—Ç–µ–Ω–∏–∏</p>

                <form id="plantForm" enctype="multipart/form-data" style="display:grid;gap:12px">
                    <div>
                        <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                        <input id="title" name="title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ–π –¥—É–±–∏–∫" />
                    </div>

                    <div>
                        <label for="plantType">–¢–∏–ø —Ä–∞—Å—Ç–µ–Ω–∏—è</label>
                        <select id="plantType" name="plantType" required>
                            <option value="Tree">–î–µ—Ä–µ–≤–æ</option>
                            <option value="Shrub">–ö—É—Å—Ç–∞—Ä–Ω–∏–∫</option>
                            <option value="Flower">–¶–≤–µ—Ç–æ–∫</option>
                            <option value="Other">–î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>

                    <div>
                        <label for="location">–ú–µ—Å—Ç–æ –ø–æ—Å–∞–¥–∫–∏</label>
                        <input id="location" name="location" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∏–ª–∏ –∞–¥—Ä–µ—Å" />
                    </div>

                    <div>
                        <label>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ</label>
                        <div id="map" style="height:200px;border:1px solid #ddd;border-radius:8px;margin-bottom:8px">
                        </div>
                        <input type="hidden" id="lat" name="lat" />
                        <input type="hidden" id="lng" name="lng" />
                        <small style="color:#999;font-size:0.85rem">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç—É, —á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å –º–µ—Å—Ç–æ</small>
                    </div>

                    <div>
                        <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ / –∑–∞–º–µ—Ç–∫–∏</label>
                        <textarea id="description" name="description" rows="3"
                            style="width:100%;padding:8px;border:1px solid #ddd;border-radius:8px;font-size:0.95rem"></textarea>
                    </div>

                    <div>
                        <label for="beforeVideo">–í–∏–¥–µ–æ ‚Äî –î–û</label>
                        <input id="beforeVideo" name="beforeVideo" type="file" accept="video/*" />
                    </div>

                    <div>
                        <label for="afterVideo">–í–∏–¥–µ–æ ‚Äî –ü–û–°–õ–ï</label>
                        <input id="afterVideo" name="afterVideo" type="file" accept="video/*" />
                    </div>

                    <div style="display:flex;gap:8px">
                        <button type="submit"
                            style="flex:1;padding:10px;background:#24b06b;color:white;border:none;border-radius:8px;font-weight:600;cursor:pointer">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        <a href="/"
                            style="flex:1;padding:10px;background:#f0f0f0;border:1px solid #e6e9ef;border-radius:8px;text-align:center;text-decoration:none;font-weight:600">–û—Ç–º–µ–Ω–∞</a>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="/" class="nav-item">
            <span class="icon">üè†</span>
            <span>–ì–ª–∞–≤–Ω–∞—è</span>
        </a>
        <a href="/register-tree" class="nav-item active">
            <span class="icon">ü™¥</span>
            <span>–ü–æ—Å–∞–¥–∫–∞</span>
        </a>
        <a href="/exchange" class="nav-item">
            <span class="icon">üíù</span>
            <span>–ú–∞–≥–∞–∑–∏–Ω</span>
        </a>
        <a href="/ranking" class="nav-item">
            <span class="icon">üèÜ</span>
            <span>–†–µ–π—Ç–∏–Ω–≥</span>
        </a>
        <a href="#" class="nav-item" id="profileNavLink">
            <span class="icon">üë§</span>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </a>
    </nav>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const meRes = await fetch('/api/me')
                if (meRes.ok) {
                    const me = await meRes.json()
                    document.getElementById('profileNavLink').href = `/profile/${me.id}`
                }
            } catch (err) {
                console.error('Failed to load user:', err)
            }
        })
    </script>
    <script src="/nav.js"></script>
    <script src="/register_tree.js"></script>
</body>

</html>